openapi: 3.0.0
info:
    version: '1'
    title: P2P Lending Syariah API
    description: |
        ## Ready APIs 
        #### Authentications: `✅ All APIs are ready`

        <br/>
        | BORROWERS                                         | Status      |
        | ------------------------------------------------ | ------------ |
        | `Verification data borrower`                     | `✅Ready`
        | `Post request loan`                             | `✅Ready`
        | `Get current borrower loan history`             | `✅Ready`
        | `Get payment schedule of current borrower`        | `✅Ready`

        <br/>
        | LENDERS                                           | Status       |
        | ------------------------------------------------- | ------------ |
        | `Get lender profile data`                         | `✅Ready`
        | `Lender funding loan request`                     | `✅Ready`
        | `Lender auto funding`                             | `✅Ready`
        | `Get lender profit imbal hasil dan pendanaan`     | `✅Ready`
        | `Verification KYC data lender`                    | `✅Ready`

        <br/>
        | LOANS                                            | Status       |
        | ------------------------------------------------ | ----------|
        | `Get all available loans`                        | `✅Ready`
        | `Get loan detail by loanId`                      | `✅Ready`

        <br/>
        | BALANCE                                         | Status       |
        | ------------------------------------------------ | ----------|
        | `Get balance of current user`                    | `✅Ready`
        | `Top up balance`                                 | `✅Ready`

        ---
        ## Available users for testing
        **<a href='https://frhnmii.notion.site/User-credentials-57e388b1807c4094ae302fc78a386d47'>https://frhnmii.notion.site/User-credentials-57e388b1807c4094ae302fc78a386d47</a>**

servers:
    # Added by API Auto Mocking Plugin
    - description: GCP Production Server
      url: https://amanah-syariah.as.r.appspot.com/api
    - description: Local Server
      url: http://localhost:8000/api
tags:
    - name: authentications
      description: Operations about user authentications
      # externalDocs:
      #   description: Find out more
      #   url: 'http://swagger.io'
    - name: borrowers
      description: Operations about borrower
    - name: lenders
      description: Operations about lender
    - name: loans
      description: Operations about loans
    - name: balance
      description: Operations about balance

paths:
    /authentication/login?action=email-otp:
        post:
            tags:
                - authentications
            summary: User login API to send OTP to user email
            operationId: login
            responses:
                '500':
                    description: Internal server error
                    content:
                        application/json:
                            schema:
                                allOf:
                                    - $ref: '#/components/schemas/ResponseError'
                                    - type: object
                                      properties:
                                          message:
                                              type: string
                                              example: Internal server error

                '404':
                    description: User not found
                    content:
                        application/json:
                            schema:
                                allOf:
                                    - $ref: '#/components/schemas/ResponseError'
                                    - type: object
                                      properties:
                                          message:
                                              type: string
                                              example: We can't find your account.

                '401':
                    description: User not verified
                    content:
                        application/json:
                            schema:
                                allOf:
                                    - $ref: '#/components/schemas/ResponseError'
                                    - type: object
                                      properties:
                                          message:
                                              type: string
                                              example: Your account is not verified. Please check your email to verify your account.

                '422':
                    description: Validation Error
                    content:
                        application/json:
                            schema:
                                allOf:
                                    - $ref: '#/components/schemas/ResponseError'
                                    - type: object
                                      properties:
                                          message:
                                              type: string
                                              example: email,password is required!
                '200':
                    description: Success login and send OTP to user email
                    content:
                        application/json:
                            schema:
                                allOf:
                                    - $ref: '#/components/schemas/ApiResponse'
                                    - type: object
                                    - properties:
                                          message:
                                              type: string
                                              example: OTP has been sent to your email
                                          data:
                                              type: object
                                              properties:
                                                  userId:
                                                      type: string
                                                      example: 64041cb5e5230c4c803c56b1
                                                  otpExpired:
                                                      type: string
                                                      example: 2023-03-05T11:47:31+0700
                                                  #   resendOtpUrl:
                                                  #       type: string
                                                  #       example: /authentication/login/otp/resend/aijdia748374@384$f
                                                  email:
                                                      type: string
                                                      example: user@mail.com

            requestBody:
                description: User login with credentials
                content:
                    application/json:
                        schema:
                            $ref: '#/components/schemas/UserLogin'
                required: true

    # User verify OTP to gain access token
    /authentication/login?action=login:
        post:
            tags:
                - authentications
            summary: Verify OTP to gain access token and refresh token
            operationId: verifyLogin
            responses:
                '500':
                    description: Internal server error
                    content:
                        application/json:
                            schema:
                                allOf:
                                    - $ref: '#/components/schemas/ResponseError'
                                    - type: object
                                      properties:
                                          message:
                                              type: string
                                              example: Internal server error

                '404':
                    description: User not found
                    content:
                        application/json:
                            schema:
                                allOf:
                                    - $ref: '#/components/schemas/ResponseError'
                                    - type: object
                                      properties:
                                          message:
                                              type: string
                                              example: Your account is not registered. Please register your account first.
                '401':
                    description: OTP Not match
                    content:
                        application/json:
                            schema:
                                allOf:
                                    - $ref: '#/components/schemas/ResponseError'
                                    - type: object
                                      properties:
                                          message:
                                              type: string
                                              example: OTP code doesn't match. Please check again!
                '422':
                    description: Bad request
                    content:
                        application/json:
                            schema:
                                allOf:
                                    - $ref: '#/components/schemas/ResponseError'
                                    - type: object
                                      properties:
                                          message:
                                              type: string
                                              example: email,otp is required!
                '400':
                    description: Bad request
                    content:
                        application/json:
                            schema:
                                allOf:
                                    - $ref: '#/components/schemas/ResponseError'
                                    - type: object
                                      properties:
                                          message:
                                              type: string
                                              example: OTP Code is expired
                '200':
                    description: Success login and get access token and refresh token
                    content:
                        application/json:
                            schema:
                                allOf:
                                    - $ref: '#/components/schemas/ApiResponse'
                                    - type: object
                                    - properties:
                                          message:
                                              type: string
                                              example: Login success
                                          data:
                                              type: object
                                              properties:
                                                  accessToken:
                                                      type: string
                                                      example: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOiI2M2VkYzkyYjc5MjYyMjRhNzE4OGI0YWYiLCJyb2xlcyI6ImJvcnJvd2VyIiwiaWF0IjoxNjc2NTI5MjgyLCJleHAiOjE2NzY2MTU2ODJ9.5j-_2kXbEXB3zsXSZC7q8i6rOQvxEtlHtq3X7CsOZng
                                                  refreshToken:
                                                      type: string
                                                      example: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOiI2M2VkYzkyYjc5MjYyMjRhNzE4OGI0YWYiLCJyb2xlcyI6ImJvcnJvd2VyIiwiaWF0IjoxNjc2NTI5MjgyLCJleHAiOjE2NzkxMjEyODJ9.4sstVsYCK01F--fWJbog22onNnpJzPgazLXtVOJPnj8

            requestBody:
                description: User login with credentials
                content:
                    application/json:
                        schema:
                            type: object
                            properties:
                                email:
                                    type: string
                                    example: isco@yopmail.com
                                otp:
                                    description: user input OTP
                                    type: string
                                    example: 31349
                required: true

    /authentication/login/otp/resend:
        post:
            tags:
                - authentications
            summary: Resend OTP to user email
            operationId: resendLoginOTP
            responses:
                '500':
                    description: Internal server error
                    content:
                        application/json:
                            schema:
                                allOf:
                                    - $ref: '#/components/schemas/ResponseError'
                                    - type: object
                                      properties:
                                          message:
                                              type: string
                                              example: Internal server error

                '404':
                    description: User not found
                    content:
                        application/json:
                            schema:
                                allOf:
                                    - $ref: '#/components/schemas/ResponseError'
                                    - type: object
                                      properties:
                                          message:
                                              type: string
                                              example: We can't find your account.

                '401':
                    description: User not verified
                    content:
                        application/json:
                            schema:
                                allOf:
                                    - $ref: '#/components/schemas/ResponseError'
                                    - type: object
                                      properties:
                                          message:
                                              type: string
                                              example: Your account is not verified. Please check your email to verify your account.

                '422':
                    description: Validation Error
                    content:
                        application/json:
                            schema:
                                allOf:
                                    - $ref: '#/components/schemas/ResponseError'
                                    - type: object
                                      properties:
                                          message:
                                              type: string
                                              example: email is required!
                '200':
                    description: Success resend OTP to user email
                    content:
                        application/json:
                            schema:
                                allOf:
                                    - $ref: '#/components/schemas/ApiResponse'
                                    - type: object
                                    - properties:
                                          message:
                                              type: string
                                              example: OTP has been sent to your email
                                          data:
                                              type: object
                                              properties:
                                                  userId:
                                                      type: string
                                                      example: 64041cb5e5230c4c803c56b1
                                                  otpExpired:
                                                      type: string
                                                      example: 2023-03-05T11:47:31+0700

            requestBody:
                description: User login with credentials
                content:
                    application/json:
                        schema:
                            type: object
                            properties:
                                email:
                                    type: string
                                    example: zee@yopmail.com
                required: true

    /authentication/register:
        post:
            tags:
                - authentications
            summary: Register new user
            operationId: register
            responses:
                '500':
                    description: Internal server error
                    content:
                        application/json:
                            schema:
                                allOf:
                                    - $ref: '#/components/schemas/ResponseError'
                                    - type: object
                                      properties:
                                          message:
                                              type: string
                                              example: Internal server error
                '422':
                    description: Validation Error
                    content:
                        application/json:
                            schema:
                                allOf:
                                    - $ref: '#/components/schemas/ResponseError'
                                    - type: object
                                      properties:
                                          message:
                                              type: string
                                              example: phoneNumber is required!
                '409':
                    description: Duplicate email
                    content:
                        application/json:
                            schema:
                                allOf:
                                    - $ref: '#/components/schemas/ResponseError'
                                    - type: object
                                      properties:
                                          message:
                                              type: string
                                              example: This e-mail address has already been registered
                '201':
                    description: Success create new user
                    content:
                        application/json:
                            schema:
                                allOf:
                                    - $ref: '#/components/schemas/ApiResponse'
                                    - type: object
                                    - properties:
                                          message:
                                              type: string
                                              example: Register success. Please check your email to verify your account.
                                          data:
                                              type: object
                                              allOf:
                                                  - $ref: '#/components/schemas/User'
                                                  - type: object
                                                    properties:
                                                        createdDate:
                                                            type: string
                                                            example: 2023-03-05T03:47:17.400Z
                                                        updatedDate:
                                                            type: string
                                                            example: 2023-03-05T03:47:17.400Z

            requestBody:
                description: Payload to register new user
                content:
                    application/json:
                        schema:
                            $ref: '#/components/schemas/UserCreation'

                required: true

    /authentication/verification/email/{userId}/{token}:
        post:
            tags:
                - authentications
            summary: Verify email after user klik link in email
            operationId: verifyEmail
            parameters:
                - name: userId
                  in: path
                  description: userId from email
                  required: true
                  schema:
                      type: string
                      example: diade8328232m99me
                - name: token
                  in: path
                  description: token from email
                  required: true
                  schema:
                      type: string
                      example: 1234567890
            responses:
                '500':
                    description: Internal server error
                    content:
                        application/json:
                            schema:
                                allOf:
                                    - $ref: '#/components/schemas/ResponseError'
                                    - type: object
                                      properties:
                                          message:
                                              type: string
                                              example: Internal server error
                '400':
                    description: Parameters missing
                    content:
                        application/json:
                            schema:
                                allOf:
                                    - $ref: '#/components/schemas/ResponseError'
                                    - type: object
                                      properties:
                                          message:
                                              type: string
                                              example: userId is required
                '409':
                    description: Your account has been verified. Please login to continue using our services.
                    content:
                        application/json:
                            schema:
                                allOf:
                                    - $ref: '#/components/schemas/ResponseError'
                                    - type: object
                                      properties:
                                          message:
                                              type: string
                                              example: Your account has been verified.
                '200':
                    description: Success verify email
                    content:
                        application/json:
                            schema:
                                allOf:
                                    - $ref: '#/components/schemas/ApiResponse'
                                    - type: object
                                    - properties:
                                          message:
                                              type: string
                                              example: Your account has been successfully verified.
                                          data:
                                              type: array
                                              example: []

    /authentication/verification/email/{userId}/resend:
        post:
            tags:
                - authentications
            summary: Resend verification email
            operationId: resendEmail
            parameters:
                - name: userId
                  in: path
                  description: userId from email
                  required: true
                  schema:
                      type: string
                      example: diade8328232m99me
            responses:
                '500':
                    description: Internal server error
                    content:
                        application/json:
                            schema:
                                allOf:
                                    - $ref: '#/components/schemas/ResponseError'
                                    - type: object
                                      properties:
                                          message:
                                              type: string
                                              example: Internal server error
                '400':
                    description: Parameters missing
                    content:
                        application/json:
                            schema:
                                allOf:
                                    - $ref: '#/components/schemas/ResponseError'
                                    - type: object
                                      properties:
                                          message:
                                              type: string
                                              example: userId is required
                '409':
                    description: Your account has been verified. Please login to continue using our services.
                    content:
                        application/json:
                            schema:
                                allOf:
                                    - $ref: '#/components/schemas/ResponseError'
                                    - type: object
                                      properties:
                                          message:
                                              type: string
                                              example: Your account has been verified.
                '200':
                    description: Success send verfication email again
                    content:
                        application/json:
                            schema:
                                allOf:
                                    - $ref: '#/components/schemas/ApiResponse'
                                    - type: object
                                    - properties:
                                          message:
                                              type: string
                                              example: Verification email has been sent. Please check your email to verify your account.
                                          data:
                                              type: array
                                              example: []

    /authentication/token/refresh:
        post:
            tags:
                - authentications
            summary: Refresh access token with refresh token
            operationId: refreshToken
            responses:
                '500':
                    description: Internal server error
                    content:
                        application/json:
                            schema:
                                allOf:
                                    - $ref: '#/components/schemas/ResponseError'
                                    - type: object
                                      properties:
                                          message:
                                              type: string
                                              example: Internal server error
                '401':
                    description: Token expired or invalid
                    content:
                        application/json:
                            schema:
                                allOf:
                                    - $ref: '#/components/schemas/ResponseError'
                                    - type: object
                                      properties:
                                          message:
                                              type: string
                                              example: Your token is invalid or expired!. Please login again!

                '404':
                    description: Refresh token not found
                    content:
                        application/json:
                            schema:
                                allOf:
                                    - $ref: '#/components/schemas/ResponseError'
                                    - type: object
                                      properties:
                                          message:
                                              type: string
                                              example: We cannot find your token!

                '422':
                    description: Validation Error
                    content:
                        application/json:
                            schema:
                                allOf:
                                    - $ref: '#/components/schemas/ResponseError'
                                    - type: object
                                      properties:
                                          message:
                                              type: string
                                              example: refreshToken is required!
                '200':
                    description: success generate new access token
                    content:
                        application/json:
                            schema:
                                allOf:
                                    - $ref: '#/components/schemas/ApiResponse'
                                    - type: object
                                    - properties:
                                          message:
                                              type: string
                                              example: success generate new access token
                                          data:
                                              type: object
                                              properties:
                                                  accessToken:
                                                      type: string
                                                      example: thisisnewaccesstoken
                                                  refreshToken:
                                                      type: string
                                                      example: thisisnewrefreshtoken

            requestBody:
                description: Refresh token
                content:
                    application/json:
                        schema:
                            type: object
                            properties:
                                refreshToken:
                                    type: string
                                    example: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOiI2M2VkYzkyYjc5MjYyMjRhNzE4OGI0YWYiLCJyb2xlcyI6ImJvcnJvd2VyIiwiaWF0IjoxNjc2NTI5MDEwLCJleHAiOjE2NzkxMjEwMTB9.QNoEF0AHPguIT6HlfFvqtxlmp4TaalkXNMyawf-tt34
                required: true

    /authentication/password/reset/request:
        post:
            tags:
                - authentications
            summary: User request to reset password
            operationId: forgetPassword
            responses:
                '500':
                    description: Internal server error
                    content:
                        application/json:
                            schema:
                                allOf:
                                    - $ref: '#/components/schemas/ResponseError'
                                    - type: object
                                      properties:
                                          message:
                                              type: string
                                              example: Internal server error
                '422':
                    description: Validation Error
                    content:
                        application/json:
                            schema:
                                allOf:
                                    - $ref: '#/components/schemas/ResponseError'
                                    - type: object
                                      properties:
                                          message:
                                              type: string
                                              example: email,platform is required!
                '404':
                    description: Not Found
                    content:
                        application/json:
                            schema:
                                allOf:
                                    - $ref: '#/components/schemas/ResponseError'
                                    - type: object
                                      properties:
                                          message:
                                              type: string
                                              example: We cannot find an account with that email
                '200':
                    description: If user forgot password, user can request reset password. This endpoint will send link to user email to reset password
                    content:
                        application/json:
                            schema:
                                allOf:
                                    - $ref: '#/components/schemas/ApiResponse'
                                    - type: object
                                    - properties:
                                          message:
                                              type: string
                                              example: Your request has been processed. Please check your email to reset password!
                                          data:
                                              type: array
                                              example: []

            requestBody:
                description: Payload to request reset password
                content:
                    application/json:
                        schema:
                            type: object
                            properties:
                                email:
                                    type: string
                                    example: user@mail.com
                                platform:
                                    type: string
                                    enum:
                                        - mobile
                                        - website
                                    example: website
                required: true

    /authentication/password/reset/request/change:
        post:
            tags:
                - authentications
            summary: Change password
            operationId: forgetPassword
            responses:
                '500':
                    description: Internal server error
                    content:
                        application/json:
                            schema:
                                allOf:
                                    - $ref: '#/components/schemas/ResponseError'
                                    - type: object
                                      properties:
                                          message:
                                              type: string
                                              example: Internal server error
                '422':
                    description: Validation Error
                    content:
                        application/json:
                            schema:
                                allOf:
                                    - $ref: '#/components/schemas/ResponseError'
                                    - type: object
                                      properties:
                                          message:
                                              type: string
                                              example: email,token is required!
                '401':
                    description: Unauthorized because token is invalid
                    content:
                        application/json:
                            schema:
                                allOf:
                                    - $ref: '#/components/schemas/ResponseError'
                                    - type: object
                                      properties:
                                          message:
                                              type: string
                                              example: Invalid or expired password reset token

                '404':
                    description: Bad request
                    content:
                        application/json:
                            schema:
                                allOf:
                                    - $ref: '#/components/schemas/ResponseError'
                                    - type: object
                                      properties:
                                          message:
                                              type: string
                                              example: User with this email not found!

                '200':
                    description: Success change password after user request to reset password
                    content:
                        application/json:
                            schema:
                                allOf:
                                    - $ref: '#/components/schemas/ApiResponse'
                                    - type: object
                                    - properties:
                                          message:
                                              type: string
                                              example: success change password
                                          data:
                                              type: object
                                              properties:
                                                  userId:
                                                      type: string
                                                      example: 640410c5465ed9af9ccb8912
                                                  email:
                                                      type: string
                                                      example: user@mail.com
                                                  name:
                                                      type: string
                                                      example: user
                                                  roles:
                                                      type: string
                                                      example: lender

            requestBody:
                description: Payload to change password
                content:
                    application/json:
                        schema:
                            type: object
                            properties:
                                token:
                                    type: string
                                    example: 71f90b490af811ba0193a2b7c6795809b32a724f79e36cb15df8da59b474a1e1
                                email:
                                    type: string
                                    example: user@mail.com
                                newPassword:
                                    type: string
                                    example: Test@123
                required: true

    /loans/available:
        get:
            tags:
                - loans
            summary: Get all available loans
            operationId: getAvailableLoans
            parameters:
                - in: query
                  name: limit
                  description: limit data per page
                  schema:
                      type: integer
                      example: 10
                - in: query
                  name: page
                  description: page number
                  schema:
                      type: integer
                      example: 1
                - in: query
                  name: sort
                  description: sort data by field
                  schema:
                      type: string
                      example: createdDate
                - in: query
                  name: order
                  description: order data by asc or desc
                  schema:
                      type: string
                      example: desc
                - in: query
                  name: q
                  description: search data
                  schema:
                      type: string
                      example: lahiran
                - in: query
                  name: tenor_min
                  description: filter data by tenor minimum value.
                  schema:
                      type: string
                      example: 2
                - in: query
                  name: tenor_max
                  description: filter data by tenor maximum value.
                  schema:
                      type: string
                      example: 7
                - in: query
                  name: yield_min
                  description: filter data by yield minimum value.
                  schema:
                      type: string
                      example: 100000
                - in: query
                  name: yield_max
                  description: filter data by yield maximum value.
                  schema:
                      type: string
                      example: 100000

            responses:
                '500':
                    description: Internal server error
                    content:
                        application/json:
                            schema:
                                allOf:
                                    - $ref: '#/components/schemas/ResponseError'
                                    - type: object
                                      properties:
                                          message:
                                              type: string
                                              example: Internal server error

                '401':
                    description: Unauthorized
                    content:
                        application/json:
                            schema:
                                allOf:
                                    - $ref: '#/components/schemas/ResponseError'
                                    - type: object
                                      properties:
                                          message:
                                              type: string
                                              example: You are not authorized. Please login first to access this page.

                '200':
                    description: Success get all available loans
                    content:
                        application/json:
                            schema:
                                allOf:
                                    - $ref: '#/components/schemas/ApiResponse'
                                    - type: object
                                    - properties:
                                          message:
                                              type: string
                                              example: success get all available loans
                                          data:
                                              type: array
                                              items:
                                                  allOf:
                                                      - $ref: '#/components/schemas/Loan'
                                                  type: object
                                                  properties:
                                                      totalFunding:
                                                          type: integer
                                                          example: 1000000
                                                      borrower:
                                                          type: object
                                                          properties:
                                                              borrowerId:
                                                                  type: string
                                                                  example: 640410c5465ed9af9ccb8912
                                                              name:
                                                                  type: string
                                                                  example: Zinedine Zidane
                                                              email:
                                                                  type: string
                                                                  example: zidane@mail.com

                                          meta:
                                              type: object
                                              properties:
                                                  pagination:
                                                      allOf:
                                                          - $ref: '#/components/schemas/PaginationResponse'
                                                  totalItems:
                                                      type: integer
                                                      example: 100

    /loans/available/:loanId:
        get:
            tags:
                - loans
            summary: Get loan detail by loanId
            operationId: getDetailAvailableLoans
            responses:
                '500':
                    description: Internal server error
                    content:
                        application/json:
                            schema:
                                allOf:
                                    - $ref: '#/components/schemas/ResponseError'
                                    - type: object
                                      properties:
                                          message:
                                              type: string
                                              example: Internal server error

                '404':
                    description: Not Found
                    content:
                        application/json:
                            schema:
                                allOf:
                                    - $ref: '#/components/schemas/ResponseError'
                                    - type: object
                                      properties:
                                          message:
                                              type: string
                                              example: Loan not found

                '401':
                    description: Unauthorized
                    content:
                        application/json:
                            schema:
                                allOf:
                                    - $ref: '#/components/schemas/ResponseError'
                                    - type: object
                                      properties:
                                          message:
                                              type: string
                                              example: You are not authorized. Please login first to access this page.

                '200':
                    description: Success get loan detail
                    content:
                        application/json:
                            schema:
                                allOf:
                                    - $ref: '#/components/schemas/ApiResponse'
                                    - type: object
                                    - properties:
                                          message:
                                              type: string
                                              example: success get loan detail
                                          data:
                                              allOf:
                                                  - $ref: '#/components/schemas/Loan'
                                              type: object
                                              properties:
                                                  risk:
                                                      type: string
                                                      example: 500
                                                  totalFunding:
                                                      type: integer
                                                      example: 1000000
                                                  contract:
                                                      type: string
                                                      example: https://firbase.com/contract/123.pdf
                                                  borrower:
                                                      type: object
                                                      properties:
                                                          borrowerId:
                                                              type: string
                                                              example: 640410c5465ed9af9ccb8912
                                                          name:
                                                              type: string
                                                              example: Zinedine Zidane
                                                          email:
                                                              type: string
                                                              example: zidane@mail.com
                                                          creditScore:
                                                              type: string
                                                              example: 500

                                                          performance:
                                                              type: object
                                                              properties:
                                                                  borrowingRecord:
                                                                      type: object
                                                                      properties:
                                                                          borrowedFunds:
                                                                              type: integer
                                                                              example: 1000000
                                                                          totalBorrowing:
                                                                              type: integer
                                                                              example: 2
                                                                  repayment:
                                                                      type: object
                                                                      properties:
                                                                          earlier:
                                                                              type: integer
                                                                              example: 3
                                                                          onTime:
                                                                              type: integer
                                                                              example: 1
                                                                          late:
                                                                              type: integer
                                                                              example: 0

    /loans/recommended/:userId:
        get:
            tags:
                - loans
            summary: Get all recommended loans
            operationId: getRecommendedLoans
            security:
                - lender_auth: []
            parameters:
                - in: query
                  name: limit
                  description: limit data per page
                  schema:
                      type: integer
                      example: 10
                - in: query
                  name: page
                  description: page number
                  schema:
                      type: integer
                      example: 1
                - in: query
                  name: sort
                  description: sort data by field
                  schema:
                      type: string
                      example: createdDate
                - in: query
                  name: order
                  description: order data by asc or desc
                  schema:
                      type: string
                      example: desc
                - in: query
                  name: q
                  description: search data
                  schema:
                      type: string
                      example: lahiran

            responses:
                '500':
                    description: Internal server error
                    content:
                        application/json:
                            schema:
                                allOf:
                                    - $ref: '#/components/schemas/ResponseError'
                                    - type: object
                                      properties:
                                          message:
                                              type: string
                                              example: Internal server error

                '401':
                    description: Unauthorized
                    content:
                        application/json:
                            schema:
                                allOf:
                                    - $ref: '#/components/schemas/ResponseError'
                                    - type: object
                                      properties:
                                          message:
                                              type: string
                                              example: You are not authorized. Please login first to access this page.

                '404':
                    description: Not Found
                    content:
                        application/json:
                            schema:
                                allOf:
                                    - $ref: '#/components/schemas/ResponseError'
                                    - type: object
                                      properties:
                                          message:
                                              type: string
                                              example: User not found

                '200':
                    description: success get all recommended loans
                    content:
                        application/json:
                            schema:
                                allOf:
                                    - $ref: '#/components/schemas/ApiResponse'
                                    - type: object
                                    - properties:
                                          message:
                                              type: string
                                              example: success get all recommended loans
                                          data:
                                              type: array
                                              items:
                                                  allOf:
                                                      - $ref: '#/components/schemas/Loan'
                                                  type: object
                                                  properties:
                                                      totalFunding:
                                                          type: integer
                                                          example: 1000000
                                                      borrower:
                                                          type: object
                                                          properties:
                                                              borrowerId:
                                                                  type: string
                                                                  example: 640410c5465ed9af9ccb8912
                                                              name:
                                                                  type: string
                                                                  example: Zinedine Zidane
                                                              email:
                                                                  type: string
                                                                  example: zidane@mail.com

                                          meta:
                                              type: object
                                              properties:
                                                  pagination:
                                                      allOf:
                                                          - $ref: '#/components/schemas/PaginationResponse'
                                                  totalItems:
                                                      type: integer
                                                      example: 100

    /lenders/request/verification:
        put:
            externalDocs:
                description: For more information, see here
                url: https://lively-rocket-630275.postman.co/workspace/%5BTA%5D---P2P-Lending-Syariah~1bc383f4-a44d-4a02-ba80-a3a2f19cb3df/request/25131439-0f2ce653-57aa-4a1c-93e0-b63b152fec75?ctx=documentation
            tags:
                - lenders
            summary: Verification KYC data lender
            operationId: VerifyLender
            security:
                - lender_auth: []
            responses:
                '500':
                    description: Internal server error
                    content:
                        application/json:
                            schema:
                                allOf:
                                    - $ref: '#/components/schemas/ResponseError'
                                    - type: object
                                      properties:
                                          message:
                                              type: string
                                              example: Internal server error

                '404':
                    description: User not found
                    content:
                        application/json:
                            schema:
                                allOf:
                                    - $ref: '#/components/schemas/ResponseError'
                                    - type: object
                                      properties:
                                          message:
                                              type: string
                                              example: User not found
                '401':
                    description: Unauthorized
                    content:
                        application/json:
                            schema:
                                allOf:
                                    - $ref: '#/components/schemas/ResponseError'
                                    - type: object
                                      properties:
                                          message:
                                              type: string
                                              example: Unauthorized access. Please login first.

                '403':
                    description: Forbidden
                    content:
                        application/json:
                            schema:
                                allOf:
                                    - $ref: '#/components/schemas/ResponseError'
                                    - type: object
                                      properties:
                                          message:
                                              type: string
                                              example: Forbidden access
                '422':
                    description: Bad request
                    content:
                        application/json:
                            schema:
                                allOf:
                                    - $ref: '#/components/schemas/ResponseError'
                                    - type: object
                                      properties:
                                          message:
                                              type: string
                                              example: pekerjaan is required
                # '400':
                #     description: Bad request
                #     content:
                #         application/json:
                #             schema:
                #                 allOf:
                #                     - $ref: '#/components/schemas/ResponseError'
                #                     - type: object
                #                       properties:
                #                           message:
                #                               type: string
                #                               example: OTP Code is expired
                '200':
                    description: Success verified borrower
                    content:
                        application/json:
                            schema:
                                allOf:
                                    - $ref: '#/components/schemas/ApiResponse'
                                    - type: object
                                    - properties:
                                          message:
                                              type: string
                                              example: Success verified borrower
                                          data:
                                              example: []

            requestBody:
                description: Payload

                content:
                    multipart/form-data:
                        schema:
                            type: object
                            properties:
                                personal:
                                    type: object
                                    properties:
                                        fullName:
                                            type: string
                                            example: Eden Hazard
                                        gender:
                                            type: string
                                            enum:
                                                - Male
                                                - Female
                                        brithDate:
                                            type: string
                                            example: 1990-01-01
                                        idCardNumber:
                                            type: string
                                            example: 123456789098765
                                        work:
                                            type: object
                                            properties:
                                                name:
                                                    type: string
                                                    example: PNS
                                                salary:
                                                    type: integer
                                                    example: 5000000
                                idCardImage:
                                    type: string
                                    example: ''
                                faceImage:
                                    type: string
                                    example: ''
                        encoding: # The same level as schema
                            idCardImage:
                                contentType: image/png, image/jpeg
                            faceImage:
                                contentType: image/png, image/jpeg
                required: true

    /lenders/profile:
        get:
            tags:
                - lenders
            summary: Get lender profile data
            operationId: getLenderProfile
            security:
                - lender_auth: []
            responses:
                '500':
                    description: Internal server error
                    content:
                        application/json:
                            schema:
                                allOf:
                                    - $ref: '#/components/schemas/ResponseError'
                                    - type: object
                                      properties:
                                          message:
                                              type: string
                                              example: Internal server error

                '404':
                    description: Not Found
                    content:
                        application/json:
                            schema:
                                allOf:
                                    - $ref: '#/components/schemas/ResponseError'
                                    - type: object
                                      properties:
                                          message:
                                              type: string
                                              example: Lender not found

                '403':
                    description: Forbidden
                    content:
                        application/json:
                            schema:
                                allOf:
                                    - $ref: '#/components/schemas/ResponseError'
                                    - type: object
                                      properties:
                                          message:
                                              type: string
                                              example: You are not a lender

                '401':
                    description: Unauthorized
                    content:
                        application/json:
                            schema:
                                allOf:
                                    - $ref: '#/components/schemas/ResponseError'
                                    - type: object
                                      properties:
                                          message:
                                              type: string
                                              example: You are not authorized. Please login first to access this page.

                '200':
                    description: Success get lender profile
                    content:
                        application/json:
                            schema:
                                allOf:
                                    - $ref: '#/components/schemas/ApiResponse'
                                    - type: object
                                    - properties:
                                          message:
                                              type: string
                                              example: success get lender profile
                                          data:
                                              type: object
                                              properties:
                                                  borrowerId:
                                                      type: string
                                                      example: 640410c5465ed9af9ccb8912
                                                  name:
                                                      type: string
                                                      example: Zinedine Zidane
                                                  email:
                                                      type: string
                                                      example: zidane@mail.com
                                                  verfiied:
                                                      type: boolean
                                                      example: true
                                                  phoneNumber:
                                                      type: integer
                                                      example: 628533322211
                                                  profilePicture:
                                                      type: string
                                                      example: https://firebase.com/640410c5465ed9af9ccb8912/profilePicture.jpg

    /lenders/profit:
        get:
            tags:
                - lenders
            summary: Get lender profit imbal hasil dan pendanaan
            operationId: getLenderProfit
            security:
                - lender_auth: []
            responses:
                '500':
                    description: Internal server error
                    content:
                        application/json:
                            schema:
                                allOf:
                                    - $ref: '#/components/schemas/ResponseError'
                                    - type: object
                                      properties:
                                          message:
                                              type: string
                                              example: Internal server error

                '404':
                    description: Not Found
                    content:
                        application/json:
                            schema:
                                allOf:
                                    - $ref: '#/components/schemas/ResponseError'
                                    - type: object
                                      properties:
                                          message:
                                              type: string
                                              example: Lender not found

                '403':
                    description: Forbidden
                    content:
                        application/json:
                            schema:
                                allOf:
                                    - $ref: '#/components/schemas/ResponseError'
                                    - type: object
                                      properties:
                                          message:
                                              type: string
                                              example: You are not a lender

                '401':
                    description: Unauthorized
                    content:
                        application/json:
                            schema:
                                allOf:
                                    - $ref: '#/components/schemas/ResponseError'
                                    - type: object
                                      properties:
                                          message:
                                              type: string
                                              example: You are not authorized. Please login first to access this page.

                '200':
                    description: Success get lender profit
                    content:
                        application/json:
                            schema:
                                allOf:
                                    - $ref: '#/components/schemas/ApiResponse'
                                    - type: object
                                    - properties:
                                          message:
                                              type: string
                                              example: Success get lender profit
                                          data:
                                              type: object
                                              properties:
                                                  #   borrowerId:
                                                  #       type: string
                                                  #       example: 640410c5465ed9af9ccb8912
                                                  totalYield:
                                                      type: integer
                                                      example: 0
                                                  totalFunding:
                                                      type: integer
                                                      example: 5000000

    /lenders/funding/auto:
        post:
            tags:
                - lenders
            summary: Lender auto funding
            operationId: postAutoFunding
            security:
                - lender_auth: []
            responses:
                '500':
                    description: Internal server error
                    content:
                        application/json:
                            schema:
                                allOf:
                                    - $ref: '#/components/schemas/ResponseError'
                                    - type: object
                                      properties:
                                          message:
                                              type: string
                                              example: Internal server error
                '409':
                    description: You already have auto lend in!
                    content:
                        application/json:
                            schema:
                                allOf:
                                    - $ref: '#/components/schemas/ResponseError'
                                    - type: object
                                      properties:
                                          message:
                                              type: string
                                              example: You already have auto lend in!

                # '404':
                #     description: Not Found
                #     content:
                #         application/json:
                #             schema:
                #                 allOf:
                #                     - $ref: '#/components/schemas/ResponseError'
                #                     - type: object
                #                       properties:
                #                           message:
                #                               type: string
                #                               example: We can't find the loan request you are looking for or the loan request is already funded by other lender

                '403':
                    description: Forbidden
                    content:
                        application/json:
                            schema:
                                allOf:
                                    - $ref: '#/components/schemas/ResponseError'
                                    - type: object
                                      properties:
                                          message:
                                              type: string
                                              example: You are not a lender

                '401':
                    description: Unauthorized
                    content:
                        application/json:
                            schema:
                                allOf:
                                    - $ref: '#/components/schemas/ResponseError'
                                    - type: object
                                      properties:
                                          message:
                                              type: string
                                              example: You are not authorized. Please login first to access this page.
                '402':
                    description: Insufficient balance
                    content:
                        application/json:
                            schema:
                                allOf:
                                    - $ref: '#/components/schemas/ResponseError'
                                    - type: object
                                      properties:
                                          message:
                                              type: string
                                              example: You don't have enough balance to create auto lending. Please top up your balance before funding this loan request.

                '422':
                    description: Validation Error
                    content:
                        application/json:
                            schema:
                                allOf:
                                    - $ref: '#/components/schemas/ResponseError'
                                    - type: object
                                      properties:
                                          message:
                                              type: string
                                              example: amountToLend is required

                '201':
                    description: Success create auto lending
                    content:
                        application/json:
                            schema:
                                allOf:
                                    - $ref: '#/components/schemas/ApiResponse'
                                    - type: object
                                    - properties:
                                          message:
                                              type: string
                                              example: Auto Lend has been created. When the auto lend matches a loan, the loan will be automatically funded. We will send you a notification when this happens via your email.
                                          data:
                                              type: array
                                              example: []
            requestBody:
                description: Payload request to auto funding request
                content:
                    application/json:
                        schema:
                            type: object
                            properties:
                                tenorLength:
                                    type: object
                                    properties:
                                        start:
                                            type: integer
                                            example: 1
                                        end:
                                            type: integer
                                            example: 5
                                yieldRange:
                                    type: object
                                    properties:
                                        start:
                                            type: integer
                                            example: 50000
                                        end:
                                            type: integer
                                            example: 150000
                                borrowingCategory:
                                    type: array
                                    items:
                                        type: string
                                        example: 'Personal'
                                amountToLend:
                                    type: integer
                                    example: 5000000
                        #         lenderSignature:
                        #             type: string
                        #             format: binary
                        #             example: ''
                        # encoding: # The same level as schema
                        #     lenderSignature: # Property name (see above)
                        #         contentType: image/png, image/jpeg
                required: true

    /lenders/funding:
        post:
            tags:
                - lenders
            summary: Lender funding loan request
            operationId: postFunding
            security:
                - lender_auth: []
            responses:
                '500':
                    description: Internal server error
                    content:
                        application/json:
                            schema:
                                allOf:
                                    - $ref: '#/components/schemas/ResponseError'
                                    - type: object
                                      properties:
                                          message:
                                              type: string
                                              example: Internal server error

                '409':
                    description: Already funded
                    content:
                        application/json:
                            schema:
                                allOf:
                                    - $ref: '#/components/schemas/ResponseError'
                                    - type: object
                                      properties:
                                          message:
                                              type: string
                                              example: You already funded this loan request

                '404':
                    description: Not Found
                    content:
                        application/json:
                            schema:
                                allOf:
                                    - $ref: '#/components/schemas/ResponseError'
                                    - type: object
                                      properties:
                                          message:
                                              type: string
                                              example: We can't find the loan request you are looking for or the loan request is already funded by other lender

                '403':
                    description: Forbidden
                    content:
                        application/json:
                            schema:
                                allOf:
                                    - $ref: '#/components/schemas/ResponseError'
                                    - type: object
                                      properties:
                                          message:
                                              type: string
                                              example: You are not a lender

                '401':
                    description: Unauthorized
                    content:
                        application/json:
                            schema:
                                allOf:
                                    - $ref: '#/components/schemas/ResponseError'
                                    - type: object
                                      properties:
                                          message:
                                              type: string
                                              example: You are not authorized. Please login first to access this page.
                '402':
                    description: Insufficient balance
                    content:
                        application/json:
                            schema:
                                allOf:
                                    - $ref: '#/components/schemas/ResponseError'
                                    - type: object
                                      properties:
                                          message:
                                              type: string
                                              example: You don't have enough balance to fund this loan request. Please top up your balance before funding this loan request.

                '422':
                    description: Validation Error
                    content:
                        application/json:
                            schema:
                                allOf:
                                    - $ref: '#/components/schemas/ResponseError'
                                    - type: object
                                      properties:
                                          message:
                                              type: string
                                              example: Amount is required

                '201':
                    description: Success funding loan request
                    content:
                        application/json:
                            schema:
                                allOf:
                                    - $ref: '#/components/schemas/ApiResponse'
                                    - type: object
                                    - properties:
                                          message:
                                              type: string
                                              example: success funding loan request
                                          data:
                                              type: object
                                              properties:
                                                  contract:
                                                      type: string
                                                      example: 'https://ipfs.pdf'
            requestBody:
                description: Payload request to funding loan request
                content:
                    application/json:
                        schema:
                            type: object
                            properties:
                                loanId:
                                    type: string
                                    example: 640410c5465ed9af9ccb8912
                                amount:
                                    type: integer
                                    example: 5000000
                        #         lenderSignature:
                        #             type: string
                        #             format: binary
                        #             example: ''
                        # encoding: # The same level as schema
                        #     lenderSignature: # Property name (see above)
                        #         contentType: image/png, image/jpeg
                required: true

        get:
            tags:
                - lenders
            summary: Get lender portfolio list (loan request that already funded and active)
            operationId: getPortfolio
            security:
                - lender_auth: []
            responses:
                '500':
                    description: Internal server error
                    content:
                        application/json:
                            schema:
                                allOf:
                                    - $ref: '#/components/schemas/ResponseError'
                                    - type: object
                                      properties:
                                          message:
                                              type: string
                                              example: Internal server error

                '403':
                    description: Forbidden
                    content:
                        application/json:
                            schema:
                                allOf:
                                    - $ref: '#/components/schemas/ResponseError'
                                    - type: object
                                      properties:
                                          message:
                                              type: string
                                              example: You are not a lender

                '401':
                    description: Unauthorized
                    content:
                        application/json:
                            schema:
                                allOf:
                                    - $ref: '#/components/schemas/ResponseError'
                                    - type: object
                                      properties:
                                          message:
                                              type: string
                                              example: You are not authorized. Please login first to access this page.

                '200':
                    description: Success get lender portfolio list
                    content:
                        application/json:
                            schema:
                                allOf:
                                    - $ref: '#/components/schemas/ApiResponse'
                                    - type: object
                                    - properties:
                                          message:
                                              type: string
                                              example: success fetching lender portfolio list
                                          data:
                                              type: object
                                              properties:
                                                  active:
                                                      type: object
                                                      properties:
                                                          summary:
                                                              type: object
                                                              properties:
                                                                  totalFunding:
                                                                      type: integer
                                                                      example: 5000000
                                                                  totalYield:
                                                                      type: integer
                                                                      example: 200000
                                                          funding:
                                                              type: array
                                                              items:
                                                                  type: object
                                                                  properties:
                                                                      funds:
                                                                          type: object
                                                                          properties:
                                                                              amount:
                                                                                  type: integer
                                                                                  example: 500000
                                                                              yieldReturn:
                                                                                  type: integer
                                                                                  example: 50000
                                                                              repaymentDate:
                                                                                  type: string
                                                                                  example: 2021-10-10T00:00:00.000Z
                                                                      Loan:
                                                                          type: object
                                                                          properties:
                                                                              borrower:
                                                                                  type: object
                                                                                  properties:
                                                                                      name:
                                                                                          type: string
                                                                                          example: John Doe
                                                                                      creditScore:
                                                                                          type: integer
                                                                                          example: 500
                                                                              loan:
                                                                                  type: object
                                                                                  properties:
                                                                                      loanId:
                                                                                          type: string
                                                                                          example: 640410c5465ed9af9ccb8912
                                                                                      amount:
                                                                                          type: integer
                                                                                          example: 5000000
                                                                                      tenor:
                                                                                          type: integer
                                                                                          example: 5
                                                  done:
                                                      type: object
                                                      properties:
                                                          summary:
                                                              type: object
                                                              properties:
                                                                  totalFunding:
                                                                      type: integer
                                                                      example: 5000000
                                                                  totalYield:
                                                                      type: integer
                                                                      example: 200000
                                                          funding:
                                                              type: array
                                                              items:
                                                                  type: object
                                                                  properties:
                                                                      funds:
                                                                          type: object
                                                                          properties:
                                                                              amount:
                                                                                  type: integer
                                                                                  example: 500000
                                                                              yieldReturn:
                                                                                  type: integer
                                                                                  example: 50000
                                                                              repaymentDate:
                                                                                  type: string
                                                                                  example: 2021-10-10T00:00:00.000Z
                                                                      Loan:
                                                                          type: object
                                                                          properties:
                                                                              borrower:
                                                                                  type: object
                                                                                  properties:
                                                                                      name:
                                                                                          type: string
                                                                                          example: John Doe
                                                                                      creditScore:
                                                                                          type: integer
                                                                                          example: 500
                                                                              loan:
                                                                                  type: object
                                                                                  properties:
                                                                                      loanId:
                                                                                          type: string
                                                                                          example: 640410c5465ed9af9ccb8912
                                                                                      amount:
                                                                                          type: integer
                                                                                          example: 5000000
                                                                                      tenor:
                                                                                          type: integer
                                                                                          example: 5

    /balance:
        get:
            tags:
                - balance
            summary: Get balance of current user
            operationId: getBalance
            security:
                - lender_auth: []
            responses:
                '500':
                    description: Internal server error
                    content:
                        application/json:
                            schema:
                                allOf:
                                    - $ref: '#/components/schemas/ResponseError'
                                    - type: object
                                      properties:
                                          message:
                                              type: string
                                              example: Internal server error

                '401':
                    description: Unauthorized
                    content:
                        application/json:
                            schema:
                                allOf:
                                    - $ref: '#/components/schemas/ResponseError'
                                    - type: object
                                      properties:
                                          message:
                                              type: string
                                              example: You are not authorized. Please login first to access this page.

                '404':
                    description: Not Found
                    content:
                        application/json:
                            schema:
                                allOf:
                                    - $ref: '#/components/schemas/ResponseError'
                                    - type: object
                                      properties:
                                          message:
                                              type: string
                                              example: User not found

                '200':
                    description: success get balance of current user
                    content:
                        application/json:
                            schema:
                                allOf:
                                    - $ref: '#/components/schemas/ApiResponse'
                                    - type: object
                                    - properties:
                                          message:
                                              type: string
                                              example: success get balance
                                          data:
                                              type: object
                                              properties:
                                                  balance:
                                                      type: integer
                                                      example: 5000000

                                          meta: {}

    /balance/deposit:
        post:
            tags:
                - balance
            summary: Top up balance
            operationId: postDepositVA
            security:
                - lender_auth: []
            responses:
                '500':
                    description: Internal server error
                    content:
                        application/json:
                            schema:
                                allOf:
                                    - $ref: '#/components/schemas/ResponseError'
                                    - type: object
                                      properties:
                                          message:
                                              type: string
                                              example: Internal server error

                '404':
                    description: User not found
                    content:
                        application/json:
                            schema:
                                allOf:
                                    - $ref: '#/components/schemas/ResponseError'
                                    - type: object
                                      properties:
                                          message:
                                              type: string
                                              example: User not found
                '401':
                    description: Unauthorized
                    content:
                        application/json:
                            schema:
                                allOf:
                                    - $ref: '#/components/schemas/ResponseError'
                                    - type: object
                                      properties:
                                          message:
                                              type: string
                                              example: Unauthorized access. Please login first.

                '422':
                    description: Validation error
                    content:
                        application/json:
                            schema:
                                allOf:
                                    - $ref: '#/components/schemas/ResponseError'
                                    - type: object
                                      properties:
                                          message:
                                              type: string
                                              example: amount is required

                '200':
                    description: 'success top up balance'
                    content:
                        application/json:
                            schema:
                                allOf:
                                    - $ref: '#/components/schemas/ApiResponse'
                                    - type: object
                                    - properties:
                                          message:
                                              type: string
                                              example: success top up balance
                                          data:
                                              type: object
                                              properties:
                                                  paymentLink:
                                                      type: string
                                                      example: flip.id/payment/123456789
                                          meta: {}

            requestBody:
                description: Payload request to deposit balance
                content:
                    application/json:
                        schema:
                            type: object
                            properties:
                                amount:
                                    type: number
                                    example: 100000
                required: true

    /balance/withdraw:
        post:
            tags:
                - balance
            summary: Withdraw balance
            operationId: withdrawBalance
            security:
                - lender_auth: []
            responses:
                '500':
                    description: Internal server error
                    content:
                        application/json:
                            schema:
                                allOf:
                                    - $ref: '#/components/schemas/ResponseError'
                                    - type: object
                                      properties:
                                          message:
                                              type: string
                                              example: Internal server error

                '404':
                    description: Not Found
                    content:
                        application/json:
                            schema:
                                allOf:
                                    - $ref: '#/components/schemas/ResponseError'
                                    - type: object
                                      properties:
                                          message:
                                              type: string
                                              example: We can't find this account number. Please check again.

                '403':
                    description: Forbidden
                    content:
                        application/json:
                            schema:
                                allOf:
                                    - $ref: '#/components/schemas/ResponseError'
                                    - type: object
                                      properties:
                                          message:
                                              type: string
                                              example: You are not a lender

                '402':
                    description: Insufficient balance
                    content:
                        application/json:
                            schema:
                                allOf:
                                    - $ref: '#/components/schemas/ResponseError'
                                    - type: object
                                      properties:
                                          message:
                                              type: string
                                              example: Your balance is not enough to withdraw.

                '401':
                    description: Unauthorized
                    content:
                        application/json:
                            schema:
                                allOf:
                                    - $ref: '#/components/schemas/ResponseError'
                                    - type: object
                                      properties:
                                          message:
                                              type: string
                                              example: You are not authorized. Please login first to access this page.

                '422':
                    description: Validation Error
                    content:
                        application/json:
                            schema:
                                allOf:
                                    - $ref: '#/components/schemas/ResponseError'
                                    - type: object
                                      properties:
                                          message:
                                              type: string
                                              example: AccountNumber field(s) is required

                '200':
                    description: Success withdraw balance
                    content:
                        application/json:
                            schema:
                                allOf:
                                    - $ref: '#/components/schemas/ApiResponse'
                                    - type: object
                                    - properties:
                                          message:
                                              type: string
                                              example: Success withdraw balance
                                          data:
                                              type: array
                                              example: []
            requestBody:
                description: Payload request to withdraw balance
                content:
                    application/json:
                        schema:
                            type: object
                            properties:
                                accountNumber:
                                    type: number
                                    example: 123456789
                                bankCode:
                                    type: string
                                    example: BCA
                                amount:
                                    type: number
                                    example: 100000
                required: true

    /balance/account:
        get:
            tags:
                - balance
            summary: 'Get bank account of current user. All Parameters are optional'
            operationId: getBankAccount
            parameters:
                - in: query
                  name: limit
                  description: limit data per page
                  schema:
                      type: integer
                      example: 10
                - in: query
                  name: page
                  description: page number
                  schema:
                      type: integer
                      example: 1
                - in: query
                  name: sort
                  description: sort data by field
                  schema:
                      type: string
                      example: createdDate
                - in: query
                  name: order
                  description: order data by asc or desc
                  schema:
                      type: string
                      example: desc

            security:
                - lender_auth: []
                - borrower_auth: []
            responses:
                '500':
                    description: Internal server error
                    content:
                        application/json:
                            schema:
                                allOf:
                                    - $ref: '#/components/schemas/ResponseError'
                                    - type: object
                                      properties:
                                          message:
                                              type: string
                                              example: Internal server error

                '403':
                    description: Forbidden
                    content:
                        application/json:
                            schema:
                                allOf:
                                    - $ref: '#/components/schemas/ResponseError'
                                    - type: object
                                      properties:
                                          message:
                                              type: string
                                              example: You are not a lender

                '401':
                    description: Unauthorized
                    content:
                        application/json:
                            schema:
                                allOf:
                                    - $ref: '#/components/schemas/ResponseError'
                                    - type: object
                                      properties:
                                          message:
                                              type: string
                                              example: You are not authorized. Please login first to access this page.

                '200':
                    description: Success get bank account
                    content:
                        application/json:
                            schema:
                                allOf:
                                    - $ref: '#/components/schemas/ApiResponse'
                                    - type: object
                                    - properties:
                                          message:
                                              type: string
                                              example: Success get bank account
                                          data:
                                              type: array
                                              items:
                                                  type: object
                                                  properties:
                                                      _id:
                                                          type: string
                                                          example: 5f9b2b3b5f9b2b3b5f9b2b3b
                                                      #   bankName:
                                                      #       type: string
                                                      #       example: Bank Central Asia
                                                      bankCode:
                                                          type: string
                                                          example: BCA
                                                      accountNumber:
                                                          type: string
                                                          example: 1234567890
                                          meta:
                                              type: object
                                              properties:
                                                  pagination:
                                                      allOf:
                                                          - $ref: '#/components/schemas/PaginationResponse'
                                                  totalItems:
                                                      type: integer
                                                      example: 100

        post:
            tags:
                - balance
            summary: Add new bank account
            operationId: addBankAccount
            security:
                - lender_auth: []
                - borrower_auth: []
            responses:
                '500':
                    description: Internal server error
                    content:
                        application/json:
                            schema:
                                allOf:
                                    - $ref: '#/components/schemas/ResponseError'
                                    - type: object
                                      properties:
                                          message:
                                              type: string
                                              example: Internal server error
                '409':
                    description: Already exist
                    content:
                        application/json:
                            schema:
                                allOf:
                                    - $ref: '#/components/schemas/ResponseError'
                                    - type: object
                                      properties:
                                          message:
                                              type: string
                                              example: Bank account already exist

                '404':
                    description: Not Found
                    content:
                        application/json:
                            schema:
                                allOf:
                                    - $ref: '#/components/schemas/ResponseError'
                                    - type: object
                                      properties:
                                          message:
                                              type: string
                                              example: We can't find this account number. Please check again.

                '403':
                    description: Forbidden
                    content:
                        application/json:
                            schema:
                                allOf:
                                    - $ref: '#/components/schemas/ResponseError'
                                    - type: object
                                      properties:
                                          message:
                                              type: string
                                              example: You are not a lender

                '401':
                    description: Unauthorized
                    content:
                        application/json:
                            schema:
                                allOf:
                                    - $ref: '#/components/schemas/ResponseError'
                                    - type: object
                                      properties:
                                          message:
                                              type: string
                                              example: You are not authorized. Please login first to access this page.

                '422':
                    description: Validation Error
                    content:
                        application/json:
                            schema:
                                allOf:
                                    - $ref: '#/components/schemas/ResponseError'
                                    - type: object
                                      properties:
                                          message:
                                              type: string
                                              example: AccountNumber field(s) is required

                '201':
                    description: Success add new bank account
                    content:
                        application/json:
                            schema:
                                allOf:
                                    - $ref: '#/components/schemas/ApiResponse'
                                    - type: object
                                    - properties:
                                          message:
                                              type: string
                                              example: Success add new bank account
                                          data:
                                              type: object
                                              properties:
                                                  bankFullName:
                                                      type: string
                                                      example: Bank Central Asia
                                                  bankCode:
                                                      type: string
                                                      example: BCA
                                                  accountNumber:
                                                      type: string
                                                      example: 1234567890
                                                  onBehalf:
                                                      type: string
                                                      example: John Doe

            requestBody:
                description: Payload request to add new bank account
                content:
                    application/json:
                        schema:
                            type: object
                            properties:
                                accountNumber:
                                    type: number
                                    example: 123456789
                                bankCode:
                                    type: string
                                    example: BCA
                required: true

        put:
            tags:
                - balance
            summary: Update bank account
            operationId: updateBankAccount
            security:
                - lender_auth: []
                - borrower_auth: []
            responses:
                '500':
                    description: Internal server error
                    content:
                        application/json:
                            schema:
                                allOf:
                                    - $ref: '#/components/schemas/ResponseError'
                                    - type: object
                                      properties:
                                          message:
                                              type: string
                                              example: Internal server error
                '409':
                    description: Already exist
                    content:
                        application/json:
                            schema:
                                allOf:
                                    - $ref: '#/components/schemas/ResponseError'
                                    - type: object
                                      properties:
                                          message:
                                              type: string
                                              example: Bank account already exist

                '404':
                    description: Not Found
                    content:
                        application/json:
                            schema:
                                allOf:
                                    - $ref: '#/components/schemas/ResponseError'
                                    - type: object
                                      properties:
                                          message:
                                              type: string
                                              example: We can't find this account number. Please check again.

                '403':
                    description: Forbidden
                    content:
                        application/json:
                            schema:
                                allOf:
                                    - $ref: '#/components/schemas/ResponseError'
                                    - type: object
                                      properties:
                                          message:
                                              type: string
                                              example: You are not a lender

                '401':
                    description: Unauthorized
                    content:
                        application/json:
                            schema:
                                allOf:
                                    - $ref: '#/components/schemas/ResponseError'
                                    - type: object
                                      properties:
                                          message:
                                              type: string
                                              example: You are not authorized. Please login first to access this page.

                '422':
                    description: Validation Error
                    content:
                        application/json:
                            schema:
                                allOf:
                                    - $ref: '#/components/schemas/ResponseError'
                                    - type: object
                                      properties:
                                          message:
                                              type: string
                                              example: AccountNumber field(s) is required

                '200':
                    description: Success update bank account
                    content:
                        application/json:
                            schema:
                                allOf:
                                    - $ref: '#/components/schemas/ApiResponse'
                                    - type: object
                                    - properties:
                                          message:
                                              type: string
                                              example: Success update bank account
                                          data:
                                              type: array
                                              example: []
            requestBody:
                description: Payload request to update bank account
                content:
                    application/json:
                        schema:
                            type: object
                            properties:
                                accountNumber:
                                    type: number
                                    example: 123456789
                                bankCode:
                                    type: string
                                    example: BCA
                required: true

    /balance/banks:
        get:
            tags:
                - balance
            summary: 'Get all bank available'
            operationId: getBanks
            security:
                - lender_auth: []
                - borrower_auth: []
            responses:
                '500':
                    description: Internal server error
                    content:
                        application/json:
                            schema:
                                allOf:
                                    - $ref: '#/components/schemas/ResponseError'
                                    - type: object
                                      properties:
                                          message:
                                              type: string
                                              example: Internal server error

                '401':
                    description: Unauthorized
                    content:
                        application/json:
                            schema:
                                allOf:
                                    - $ref: '#/components/schemas/ResponseError'
                                    - type: object
                                      properties:
                                          message:
                                              type: string
                                              example: You are not authorized. Please login first to access this page.

                '200':
                    description: Success get bank code
                    content:
                        application/json:
                            schema:
                                allOf:
                                    - $ref: '#/components/schemas/ApiResponse'
                                    - type: object
                                    - properties:
                                          message:
                                              type: string
                                              example: Success get bank info
                                          data:
                                              type: array
                                              items:
                                                  type: object
                                                  properties:
                                                      bank_code:
                                                          type: string
                                                          example: mandiri
                                                      name:
                                                          type: string
                                                          example: Mandiri
                                                      fee:
                                                          type: integer
                                                          example: 0
                                                      status:
                                                          type: string
                                                          example: OPERATIONAL
                                                      queue:
                                                          type: integer
                                                          example: 33582
                                          meta:
                                              type: object
                                              properties:
                                                  pagination:
                                                      allOf:
                                                          - $ref: '#/components/schemas/PaginationResponse'
                                                  totalItems:
                                                      type: integer
                                                      example: 100

    /borrowers/request/verification:
        put:
            externalDocs:
                description: For more information, see here
                url: https://lively-rocket-630275.postman.co/workspace/%5BTA%5D---P2P-Lending-Syariah~1bc383f4-a44d-4a02-ba80-a3a2f19cb3df/request/25131439-2b612021-6ceb-43b6-b2e3-3bbddc9d602d?ctx=documentation
            tags:
                - borrowers
            summary: Verification data borrower
            operationId: VerifyBorrower
            security:
                - borrower_auth: []
            responses:
                '500':
                    description: Internal server error
                    content:
                        application/json:
                            schema:
                                allOf:
                                    - $ref: '#/components/schemas/ResponseError'
                                    - type: object
                                      properties:
                                          message:
                                              type: string
                                              example: Internal server error

                '404':
                    description: User not found
                    content:
                        application/json:
                            schema:
                                allOf:
                                    - $ref: '#/components/schemas/ResponseError'
                                    - type: object
                                      properties:
                                          message:
                                              type: string
                                              example: User not found
                '401':
                    description: Unauthorized
                    content:
                        application/json:
                            schema:
                                allOf:
                                    - $ref: '#/components/schemas/ResponseError'
                                    - type: object
                                      properties:
                                          message:
                                              type: string
                                              example: Unauthorized access. Please login first.

                '403':
                    description: Forbidden
                    content:
                        application/json:
                            schema:
                                allOf:
                                    - $ref: '#/components/schemas/ResponseError'
                                    - type: object
                                      properties:
                                          message:
                                              type: string
                                              example: Forbidden access
                '422':
                    description: Bad request
                    content:
                        application/json:
                            schema:
                                allOf:
                                    - $ref: '#/components/schemas/ResponseError'
                                    - type: object
                                      properties:
                                          message:
                                              type: string
                                              example: pekerjaan is required
                # '400':
                #     description: Bad request
                #     content:
                #         application/json:
                #             schema:
                #                 allOf:
                #                     - $ref: '#/components/schemas/ResponseError'
                #                     - type: object
                #                       properties:
                #                           message:
                #                               type: string
                #                               example: OTP Code is expired
                '200':
                    description: Success verified borrower
                    content:
                        application/json:
                            schema:
                                allOf:
                                    - $ref: '#/components/schemas/ApiResponse'
                                    - type: object
                                    - properties:
                                          message:
                                              type: string
                                              example: Success verified borrower
                                          data:
                                              example: []

            requestBody:
                description: Payload

                content:
                    multipart/form-data:
                        schema:
                            type: object
                            properties:
                                personal:
                                    type: object
                                    properties:
                                        fullName:
                                            type: string
                                            example: Eden Hazard
                                        gender:
                                            type: string
                                            enum:
                                                - Male
                                                - Female
                                        brithDate:
                                            type: string
                                            example: 1990-01-01
                                        idCardNumber:
                                            type: string
                                            example: 123456789098765
                                        work:
                                            type: object
                                            properties:
                                                name:
                                                    type: string
                                                    example: PNS
                                                salary:
                                                    type: integer
                                                    example: 5000000
                                relativesContact:
                                    type: object
                                    properties:
                                        firstRelative:
                                            type: object
                                            properties:
                                                name:
                                                    type: string
                                                    example: John Doe
                                                relation:
                                                    type: string
                                                    example: Ibu
                                                phoneNumber:
                                                    type: string
                                                    example: 628123456789
                                        secondRelative:
                                            type: object
                                            properties:
                                                name:
                                                    type: string
                                                    example: Toni
                                                relation:
                                                    type: string
                                                    example: Anak
                                                phoneNumber:
                                                    type: string
                                                    example: 628123456789
                                idCardImage:
                                    type: string
                                    example: ''
                                faceImage:
                                    type: string
                                    example: ''
                        encoding: # The same level as schema
                            idCardImage:
                                contentType: image/png, image/jpeg
                            faceImage:
                                contentType: image/png, image/jpeg
                required: true

    /borrowers/payment/schedule:
        get:
            tags:
                - borrowers
            summary: Get payment schedule of current borrower
            operationId: VerifyBorrower
            security:
                - borrower_auth: []
            responses:
                '500':
                    description: Internal server error
                    content:
                        application/json:
                            schema:
                                allOf:
                                    - $ref: '#/components/schemas/ResponseError'
                                    - type: object
                                      properties:
                                          message:
                                              type: string
                                              example: Internal server error

                '404':
                    description: User not found
                    content:
                        application/json:
                            schema:
                                allOf:
                                    - $ref: '#/components/schemas/ResponseError'
                                    - type: object
                                      properties:
                                          message:
                                              type: string
                                              example: User not found
                '401':
                    description: Unauthorized
                    content:
                        application/json:
                            schema:
                                allOf:
                                    - $ref: '#/components/schemas/ResponseError'
                                    - type: object
                                      properties:
                                          message:
                                              type: string
                                              example: Unauthorized access. Please login first.

                '403':
                    description: Forbidden
                    content:
                        application/json:
                            schema:
                                allOf:
                                    - $ref: '#/components/schemas/ResponseError'
                                    - type: object
                                      properties:
                                          message:
                                              type: string
                                              example: Forbidden access

                # '400':
                #     description: Bad request
                #     content:
                #         application/json:
                #             schema:
                #                 allOf:
                #                     - $ref: '#/components/schemas/ResponseError'
                #                     - type: object
                #                       properties:
                #                           message:
                #                               type: string
                #                               example: OTP Code is expired
                '200':
                    description: Success get billing
                    content:
                        application/json:
                            schema:
                                allOf:
                                    - $ref: '#/components/schemas/ApiResponse'
                                    - type: object
                                    - properties:
                                          message:
                                              type: string
                                              example: Success get billing
                                          data:
                                              type: object
                                              properties:
                                                  currentMonth:
                                                      type: integer
                                                      example: 1000000
                                                  paymentSchedule:
                                                      type: array
                                                      items:
                                                          type: object
                                                          properties:
                                                              date:
                                                                  type: string
                                                                  example: 2021-01-01
                                                              amount:
                                                                  type: integer
                                                                  example: 1000000

    /borrowers/loan:
        get:
            tags:
                - borrowers
            summary: Get current borrower loan history
            security:
                - borrower_auth: []
            operationId: borrowerHistory
            responses:
                '500':
                    description: Internal server error
                    content:
                        application/json:
                            schema:
                                allOf:
                                    - $ref: '#/components/schemas/ResponseError'
                                    - type: object
                                      properties:
                                          message:
                                              type: string
                                              example: Internal server error

                '404':
                    description: User not found
                    content:
                        application/json:
                            schema:
                                allOf:
                                    - $ref: '#/components/schemas/ResponseError'
                                    - type: object
                                      properties:
                                          message:
                                              type: string
                                              example: User not found
                '401':
                    description: Unauthorized
                    content:
                        application/json:
                            schema:
                                allOf:
                                    - $ref: '#/components/schemas/ResponseError'
                                    - type: object
                                      properties:
                                          message:
                                              type: string
                                              example: Unauthorized access. Please login first.

                '403':
                    description: Forbidden
                    content:
                        application/json:
                            schema:
                                allOf:
                                    - $ref: '#/components/schemas/ResponseError'
                                    - type: object
                                      properties:
                                          message:
                                              type: string
                                              example: Forbidden access
                # '400':
                #     description: Bad request
                #     content:
                #         application/json:
                #             schema:
                #                 allOf:
                #                     - $ref: '#/components/schemas/ResponseError'
                #                     - type: object
                #                       properties:
                #                           message:
                #                               type: string
                #                               example: OTP Code is expired
                '200':
                    description: Success get loan history
                    content:
                        application/json:
                            schema:
                                allOf:
                                    - $ref: '#/components/schemas/ApiResponse'
                                    - type: object
                                    - properties:
                                          message:
                                              type: string
                                              example: Success get loan history
                                          data:
                                              type: object
                                              properties:
                                                  active:
                                                      type: object
                                                      properties:
                                                          loanId:
                                                              type: string
                                                              example: 640410c5465ed9af9ccb8912
                                                          date:
                                                              type: string
                                                              example: 2021-01-01
                                                          totalFunding:
                                                              type: integer
                                                              example: 1000000
                                                          amount:
                                                              type: integer
                                                              example: 1000000
                                                          yieldReturn:
                                                              type: integer
                                                              example: 50000
                                                          tenor:
                                                              type: integer
                                                              example: 5
                                                          paymentSchema:
                                                              type: string
                                                              example: Pelunasan Cicilan
                                                          borrowingCategory:
                                                              type: string
                                                              example: Pendidikan
                                                          loanPurpose:
                                                              type: string
                                                              example: Bayar kuliah
                                                          contract:
                                                              type: string
                                                              example: https://www.google.com.pdf
                                                  history:
                                                      type: array
                                                      items:
                                                          type: object
                                                          properties:
                                                              loanId:
                                                                  type: string
                                                                  example: 640410c5465ed9af9ccb8912
                                                              date:
                                                                  type: string
                                                                  example: 2021-01-01
                                                              amount:
                                                                  type: integer
                                                                  example: 1000000
                                                              yieldReturn:
                                                                  type: integer
                                                                  example: 1000000
                                                              tenor:
                                                                  type: integer
                                                                  example: 4
                                                              borrowingCategory:
                                                                  type: string
                                                                  example: Pendidikan

        post:
            tags:
                - borrowers
            summary: Post request loan
            operationId: requestLoan
            security:
                - borrower_auth: []
            responses:
                '500':
                    description: Internal server error
                    content:
                        application/json:
                            schema:
                                allOf:
                                    - $ref: '#/components/schemas/ResponseError'
                                    - type: object
                                      properties:
                                          message:
                                              type: string
                                              example: Internal server error

                '401':
                    description: Unauthorized
                    content:
                        application/json:
                            schema:
                                allOf:
                                    - $ref: '#/components/schemas/ResponseError'
                                    - type: object
                                      properties:
                                          message:
                                              type: string
                                              example: Unauthorized access. Please login first.

                '403':
                    description: Forbidden
                    content:
                        application/json:
                            schema:
                                allOf:
                                    - $ref: '#/components/schemas/ResponseError'
                                    - type: object
                                      properties:
                                          message:
                                              type: string
                                              example: Forbidden access
                '422':
                    description: Bad request
                    content:
                        application/json:
                            schema:
                                allOf:
                                    - $ref: '#/components/schemas/ResponseError'
                                    - type: object
                                      properties:
                                          message:
                                              type: string
                                              example: tenor is required
                '400':
                    description: Bad request
                    content:
                        application/json:
                            schema:
                                allOf:
                                    - $ref: '#/components/schemas/ResponseError'
                                    - type: object
                                      properties:
                                          message:
                                              type: string
                                              example: Minimum loan yield is 50000

                '201':
                    description: Success request loan
                    content:
                        application/json:
                            schema:
                                allOf:
                                    - $ref: '#/components/schemas/ApiResponse'
                                    - type: object
                                    - properties:
                                          message:
                                              type: string
                                              example: Loan request sent! Please check accordingly in your dashboard and your email for further information!
                                          data:
                                              example: []

            requestBody:
                description: Payload
                content:
                    application/json:
                        schema:
                            type: object
                            properties:
                                amount:
                                    type: integer
                                    example: 500000
                                tenor:
                                    type: integer
                                    example: 5
                                borrowringCategory:
                                    type: string
                                    enum:
                                        - Pendidikan
                                        - Kesehatan
                                        - Rumah Tangga
                                        - Pekerjaan
                                        - Hiburan
                                        - Lainnya
                                purpose:
                                    type: string
                                    example: Bayar kuliah
                                yieldReturn:
                                    type: integer
                                    example: 50000
                                paymentSchema:
                                    type: string
                                    enum:
                                        - Pelunasan Cicilan
                                        - Pelunasan Pokok
                required: true

components:
    schemas:
        User:
            allOf:
                - $ref: '#/components/schemas/UserCreation'
                - type: object
                  properties:
                      userId:
                          type: string
                          example: 640410c5465ed9af9ccb8912
                      verified:
                          type: boolean
                          example: false
        UserCreation:
            type: object
            properties:
                email:
                    type: string
                    example: ramos@mail.com
                name:
                    type: string
                    example: Sergio Ramos
                phoneNumber:
                    type: string
                    example: 628123456789
                roles:
                    type: string
                    example: lender
                password:
                    type: string
                    example: Test@123

        Borrower:
            type: object
            properties:
                borrowerId:
                    type: string
                    example: 640410c5465ed9af9ccb8955
                userId:
                    type: string
                    example: 640410c5465ed9af9ccb8912
                loanLimit:
                    type: string
                    example: 10000000
                income:
                    type: string
                    example: 15000000
                status:
                    type: string
                    example: on request

        Lender:
            type: object
            properties:
                lenderId:
                    type: string
                    example: 640410c5465ed9af9ccb8955
                userId:
                    type: string
                    example: 640410c5465ed9af9ccb8912

        Balance:
            type: object
            properties:
                balanceId:
                    type: string
                    example: 640410c5465ed9af9ccb8955
                userId:
                    type: string
                    example: 640410c5465ed9af9ccb8912
                balance:
                    type: string
                    example: 10000000

        Loan:
            type: object
            properties:
                loanId:
                    type: string
                    example: 640410c5465ed9af9ccb8955
                userId:
                    type: string
                    example: 640410c5465ed9af9ccb8912
                purpose:
                    type: string
                    example: Biaya Nikahan Untuk Anak
                borrowingCategory:
                    type: string
                    enum:
                        - personal
                        - business
                        - education
                    example: personal
                amount:
                    type: integer
                    format: int64
                    example: 20000000
                tenor:
                    type: integer
                    example: 3
                yieldReturn:
                    type: integer
                    format: int64
                    example: 500000
                status:
                    type: string
                    example: on request

        UserLogin:
            type: object
            properties:
                email:
                    type: string
                    example: user@mail.com
                password:
                    type: string
                    example: Test@123
        ApiResponse:
            type: object
            properties:
                success:
                    type: boolean
                message:
                    type: string
                data:
                    type: array
                    # example: []
                meta:
                    type: object
                    # example: {}
        ResponseError:
            type: object
            properties:
                success:
                    type: boolean
                    example: false
                message:
                    type: string
                    example: Response message
                data:
                    type: array
                    example: []
                meta:
                    type: object
                    example: {}
        PaginationResponse:
            type: object
            properties:
                totalPages:
                    type: integer
                    example: 5
                currentPage:
                    type: integer
                    example: 2
                nextPage:
                    type: string
                    example: 'localhost:8000/api/v1/loans?page=3&limit=10'
                previousPage:
                    type: string
                    example: 'localhost:8000/api/v1/loans?page=1&limit=10'
                limit:
                    type: integer
                    example: 10

    securitySchemes:
        lender_auth:
            type: http
            scheme: bearer
            bearerFormat: JWT
        borrower_auth:
            type: http
            scheme: bearer
            bearerFormat: JWT
